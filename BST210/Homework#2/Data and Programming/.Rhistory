dat[abs(dat$dfit)>(4*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
dat$dfit = dffits(age2_gender_bmi.tc)
dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
dat$dfit = dffits(age2_gender_bmi.tc)
dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")].sort()
dat$dfit = dffits(age2_gender_bmi.tc)
dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")][order(abs(dfit)),]
dat$dfit = dffits(age2_gender_bmi.tc)
dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")][order(abs(dat$dfit)),]
dat$dfit = dffits(age2_gender_bmi.tc)
dat[order(abs(dat$dfit)),][abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
dat$dfit = dffits(age2_gender_bmi.tc)
dat[order(-abs(dat$dfit)),][abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
dat$dfit = dffits(age2_gender_bmi.tc)
head(dat[order(-abs(dat$dfit)),][abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")])
dat$dfit = dffits(age2_gender_bmi.tc)
dat[order(-abs(dat$dfit)),][abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
dat$dfit = dffits(age2_gender_bmi.tc)
dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order()]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order()]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order(dfit)]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order(-high_dfit$dfit)]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order(-abs(high_dfit$dfit),]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order(-abs(high_dfit$dfit)),]
dat$dfit = dffits(age2_gender_bmi.tc)
high_dfit = dat[abs(dat$dfit)>(2*sqrt((p+1)/n)), c("age","gender","bmi","tc","dfit")]
high_dfit = high_dfit[order(-abs(high_dfit$dfit)),]
high_dfit
dat[(dat$cook > 4/n) & (dat$hat > 2*(p+1)/n), c("age","gender","bmi","tc","hat", "cook")]
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
plot(raw,standard,int_student,ext_student)
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
plot(raw,standard)
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
return (res)
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
plot(raw,standard)
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
return (res)
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
plot(raw,standard)
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
return (res)
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
print(res)
return (res)
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
print(res)
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
res
}
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
res
}
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
return(res)
}
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/sqrt(SSE/(n-p-1))
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
SSE
res = raw/sqrt(SSE/(n-p-1))
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
print(SSE)
res = raw/sqrt(SSE/(n-p-1))
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
print(SSE)
res = raw/sqrt(SSE/(n-p-1))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
print(SSE)
res = raw/(sqrt(SSE/(n-p-1)))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
print(raw)
SSE = sum(raw^2)
print(SSE)
res = raw/(sqrt(SSE/(n-p-1)))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
print(sqrt(SSE/(n-p-1)))
res = raw/(sqrt(SSE/(n-p-1)))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
print(SSE/(n-p-1))
res = raw/(sqrt(SSE/(n-p-1)))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
print(SSE)
res = raw/(sqrt(SSE/(n-p-1)))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
SSE/()
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/(sqrt(SSE/(n-p-1)))
print(res)
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/(sqrt(SSE/(n-p-1)))
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
standard
standardized_res = function(model,n,p){
raw = residuals(model)
SSE = sum(raw^2)
res = raw/(sqrt(SSE/(n-p-1)))
return(res)
}
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
mean(standard)
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
raw = residuals(age2_gender_bmi.tc)
nrow(raw)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
raw = residuals(age2_gender_bmi.tc)
raw
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
raw = residuals(age2_gender_bmi.tc)
length(raw)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
raw = residuals(age2_gender_bmi.tc)
length(raw)
standard = standardized_res(age2_gender_bmi.tc, nrow(age2_gender_bmi.tc), 4)
length(standard)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
raw = residuals(age2_gender_bmi.tc)
length(raw)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
length(standard)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
residuals
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
cor(residuals)
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
plot(residuals)
cor(residuals)
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
plot(residuals)
cor.test(residuals)
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
plot(residuals)
cor(residuals)
?cor()
raw = residuals(age2_gender_bmi.tc)
standard = standardized_res(age2_gender_bmi.tc, 527, 4)
int_student = rstandard(age2_gender_bmi.tc)
ext_student = rstudent(age2_gender_bmi.tc)
residuals = data.frame(raw,standard,int_student,ext_student)
plot(residuals)
cor(residuals, method = "pearson")
mean(raw)
mean(raw)
mean(standard)
mean(raw)
mean(standard)
mean(ext_student)
mean(int_student)
hist(ext_student)
curve(pnorm(x, mean = 0, sd=1), col = "red", add = T)
hist(ext_student, freq = T)
curve(pnorm(x, mean = 0, sd=1), col = "red", add = T)
hist(ext_student, probability = T)
curve(pnorm(x, mean = 0, sd=1), col = "red", add = T)
hist(ext_student, probability = T)
curve(pnorm(x), col = "red", add = T)
hist(ext_student, probability = T)
curve(dnorm(x), mean = mean(ext_student), sd = sqrt(var(ext_student)), col = "red", add = T)
hist(ext_student, probability = T)
m = mean(ext_student)
std = sqrt(var(ext_student))
curve(dnorm(x, mean = m, sd = std), col = "red", add = T)
par(mfrow = c(1,2))
hist(ext_student, probability = T)
m = mean(ext_student)
std = sqrt(var(ext_student))
curve(dnorm(x, mean = m, sd = std), col = "red", add = T)
qqnorm(ext_student)
qqline(ext_student, col = "red")
dat$stdres = standard
dat[dat$stdres > 2]
dat$stdres = standard
dat[dat$stdres > 2,]
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","hat")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","hat")]
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","hat")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","hat")]
resid3
cook1 = dat[dat$cook > 4/n, c("age","gender","bmi","tc","cook")]
cook2 = dat[dat$cook > 12/n, c("age","gender","bmi","tc","cook")]
head(cook1)
cook2
dat$hat = hat_val
hist(hat_val)
boxplot(hat_val)
lev1 = dat[dat$hat > 2*(p+1)/n, c("age","gender","bmi","tc","hat")]
head(lev1)
lev2 = dat[dat$hat > 4*(p+1)/n, c("age","gender","bmi","tc","hat")]
lev2
describe(raw)
summary(raw)
mean(standard)
mean(ext_student)
mean(int_student)
summary(raw)
summary(standard)
summary(ext_student)
summary(int_student)
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","hat")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","hat")]
resid2
resid3
summary(dat)
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","hat")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","hat")]
resid2
resid3
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","hat")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","hat")]
resid2
resid3
predict(age2_gender_bmi.tc)[c(103,451,514)]
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","stdres")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","stdres")]
resid2
resid3
resid3predict(age2_gender_bmi.tc)[c(103,451,514)]
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","stdres")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","stdres")]
resid2
resid3
resid3 - predict(age2_gender_bmi.tc)[c(103,451,514)]
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","stdres")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","stdres")]
resid2
resid3
resid3["tc"] - predict(age2_gender_bmi.tc)[c(103,451,514)]
dat$stdres = standard
resid2 = dat[dat$stdres > 2,c("age","gender","bmi","tc","stdres")]
resid3 = dat[dat$stdres > 3,c("age","gender","bmi","tc","stdres")]
resid2
resid3
predict(age2_gender_bmi.tc)[c(103,451,514)]
dat$hat = hat_val
hist(hat_val)
boxplot(hat_val)
lev1 = dat[dat$hat > 2*(p+1)/n, c("age","gender","bmi","tc","hat")]
head(lev1)
lev2 = dat[dat$hat > 4*(p+1)/n, c("age","gender","bmi","tc","hat")]
lev2
attach(dat)
mean(age)
mean(bmi)
detach(dat)
cook1 = dat[dat$cook > 4/n, c("age","gender","bmi","tc","cook")]
cook2 = dat[dat$cook > 12/n, c("age","gender","bmi","tc","cook")]
head(cook1)
cook2
dat[(dat$stdres > 3) && (dat$cook > 4/n) & (dat$hat > 2*(p+1)/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) && (dat$cook > 4/n) & (dat$hat > 2*(p+1)/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) && (dat$cook > 4/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) & (dat$cook > 4/n) & (dat$hat > 2*(p+1)/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) & (dat$cook > 4/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) & (dat$cook > 12/n) & (dat$hat > 4*(p+1)/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) & (dat$cook > 12/n), c("age","gender","bmi","tc","hat", "cook")]
dat[(dat$stdres > 3) & (dat$hat > 4*(p+1)/n), c("age","gender","bmi","tc","hat", "cook")]
newdat = dat[-((dat$stdres > 3) or (dat$cook > 12/n) or (dat$hat > 4*(p+1)/n)),]
newdat = dat[-((dat$stdres > 3) / (dat$cook > 12/n) / (dat$hat > 4*(p+1)/n)),]
newdat = dat[-((dat$stdres > 3) / (dat$cook > 12/n) / (dat$hat > 4*(p+1)/n)),]
newdat
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),]
newdat
dat[(dat$stdres > 3) & (dat$cook > 12/n) & (dat$hat > 4*(p+1)/n), c("age","gender","bmi","tc","hat", "cook","stdres")]
dat[(dat$stdres > 3) & (dat$cook > 12/n), c("age","gender","bmi","tc","hat", "cook", "stdres")]
dat[(dat$stdres > 3) & (dat$hat > 4*(p+1)/n), c("age","gender","bmi","tc","hat", "cook", "stdres")]
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
newdat
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
newmodel = lm(tc~ age +I(age^2) + gender + bmi, data = newdat)
summary(newmodel)
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
newmodel = lm(tc~ age +I(age^2) + gender + bmi, data = newdat)
summary(newmodel)
summary(age2_gender_bmi.tc)
dat[(dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n),c("age","gender","bmi","tc","hat", "cook","stdres")]
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
newmodel = lm(tc~ age +I(age^2) + gender + bmi, data = newdat)
summary(newmodel)
summary(age2_gender_bmi.tc)
dat[(dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n),c("age","gender","bmi","tc","hat", "cook","stdres")]
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
newmodel = lm(tc~ age +I(age^2) + gender + bmi, data = newdat)
summary(newmodel)
summary(age2_gender_bmi.tc)
dat[(dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n),c("age","gender","bmi","tc","hat", "cook","stdres")]
newdat = dat[-((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
nrow(newdat)
newmodel = lm(tc~ age +I(age^2) + gender + bmi, data = newdat)
summary(newmodel)
summary(age2_gender_bmi.tc)
dat[(dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n),c("age","gender","bmi","tc","hat", "cook","stdres")]
newdat = dat[!((dat$stdres > 3) | (dat$cook > 12/n) | (dat$hat > 4*(p+1)/n)),c("age","gender","bmi","tc","hat", "cook","stdres")]
nrow(newdat)
newmodel = lm(tc~ age +I(age^2) + gender + bmi, data = newdat)
summary(newmodel)
summary(age2_gender_bmi.tc)
par(mfrow = c(1,2))
hist(ext_student, probability = T)
m = mean(ext_student)
std = sqrt(var(ext_student))
curve(dnorm(x, mean = m, sd = std), col = "red", add = T)
qqnorm(ext_student)
qqline(ext_student, col = "red")
